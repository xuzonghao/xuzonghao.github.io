---
layout: post
title:  "LVS相关"
date:   2016-06-03
categories: lvs
---


```
10.69.249.17
10.69.249.18
提案注释配置loopback地址
cd /etc/keepalived && cp -a lvs.conf lvs.conf.$date
vim lvs.conf  //添加需要的内容
比对2个文件差异和md5且review一下
查看soure ip
cat /var/run/checkers.pid
kill -HUB $pid
ipvsadm -ln -t vip:port

查看流量
ipvsadm -ln --rate -t 1.1.1.1:80 

校验md5（7层）
获取md5 genhash   -s  172.16.105.191 -p 80 -u/testurl/test.jsp
            url {
              path /testurl/test.jsp
              digest 640205b7b0fc66c1ea91c463fac6334d
            }

```


```
实例：
global_defs {
        notification_email {
                yongrui@staff.sina.com.cn
        }

        notification_email_from keepalived@staff.sina.com.cn
        vrrp_email_subject "理想国际"
        smtp_server 127.0.0.1
        smtp_connect_timeout 1
}

vrrp_sync_group VG_1 {
        group {
                VI_2
        }
        #smtp_alert
}

vrrp_instance VI_2 {
        state BACKUP
        interface eth0
        virtual_router_id 165

        advert_int 1

        order {
                10.210.12.55
                10.210.12.14
        }

        authentication {
                auth_type PASS
                auth_pass W@dw3_lQ
        }
        virtual_ipaddress {
                10.210.12.10/24
        }

        #smtp_alert
        nopreempt
}

```